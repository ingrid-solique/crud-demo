<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/vaadin-grid/vaadin-grid.html">
<link rel="import" href="../../bower_components/vaadin-grid/vaadin-grid-sorter.html">
<link rel="import" href="../../bower_components/vaadin-grid/vaadin-grid-column-group.html">
<link rel="import" href="../../bower_components/vaadin-text-field/vaadin-text-field.html">
<link rel="import" href="../../bower_components/vaadin-button/vaadin-button.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/crud-view/crud-list-mixin.html">
<link rel="import" href="../../bower_components/crud-view/crud-view.html">

<link rel="import" href="crud-user-editor.html">

<dom-module id="crud-user-list">
  <template>
    <style>
    </style>

    <iron-ajax auto url="/dummy/users.json" handle-as="json" last-response="{{items}}"></iron-ajax>

    <crud-view desktop-view=[[desktopView]] filter-value="{{_filterValue}}"
        item="[[_editableItem]]" button-text="New user"
        on-new-item="_newItem" on-closed="_onClose" on-before-close="_onBeforeClose">

      <vaadin-text-field slot="header" placeholder="Search ..." value="{{_filterValue}}"></vaadin-text-field>
      <vaadin-button slot="header" on-click="_newItem">New Item</vaadin-button>

      <vaadin-grid slot="grid" id="grid" items="[[_filterItems(items.*, _filterValue)]]" active-item="{{_activeItem}}">
          <vaadin-grid-column width="270px" flex-grow="5">
            <template class="header">
              <vaadin-grid-sorter path="email">Email</vaadin-grid-sorter>
            </template>
            <template>
              <div>
                [[item.email]]
              </div>
            </template>
          </vaadin-grid-column>
          <vaadin-grid-column width="200px" flex-grow="5">
            <template class="header">
              <vaadin-grid-sorter path="name">Name</vaadin-grid-sorter>
            </template>
            <template>[[item.name]] [[item.last]]</template>
          </vaadin-grid-column>
          <vaadin-grid-column>
            <template class="header">
              <vaadin-grid-sorter path="role">Role</vaadin-grid-sorter>
            </template>
            <template>[[item.role]]</template>
          </vaadin-grid-column>
        <vaadin-grid-column-group>
      </vaadin-grid>

      <crud-user-editor slot="editor" id="editor"
        item="[[_editableItem]]" on-save="_onSave" on-delete="_onDelete">
      </crud-user-editor>
    </crud-view>
  </template>

  <script>
    class CrudUserList extends window.CrudListMixin(Polymer.Element) {
      static get is() {
        return 'crud-user-list';
      }

      static get properties() {
        return {
          desktopView: Boolean,
          _filterValue: String
        };
      }
    }

    window.customElements.define(CrudUserList.is, CrudUserList);
  </script>
</dom-module>
